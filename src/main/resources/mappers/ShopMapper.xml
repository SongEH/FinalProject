<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="first.final_project.dao.ShopMapper">


    <!-- 가게추가 -->
    <!-- <insert id="insert" parameterType="first.final_project.vo.ShopVo"> -->
    <insert id="insert" parameterType="shop"> insert into shop ( shop_id, shop_name, shop_img,
        shop_addr, food_category, shop_call, shop_content, shop_min_price, shop_rate,
        shop_stemp_count, shop_review_count, shop_open_time, shop_close_time, shop_close_day,
        shop_area, shop_cdate, shop_mdate, shop_status ) values ( null, #{shop_name}, #{shop_img},
        #{shop_addr}, #{food_category}, #{shop_call}, #{shop_content}, #{shop_min_price}, default,
        default, default, #{shop_open_time}, #{shop_close_time}, #{shop_close_day}, #{shop_area},
        default, default, #{shop_status} ) </insert>

    <!-- 전체 리스트 조회  -->
    <select id="selectList" parameterType="String" resultType="shop"> select * from shop <where>
            <if test="food_category !=null and food_category != ''"> food_category =#{food_category} </if>
        </where>
    </select>

    <!-- 푸드카테고리별 조회  -->


    <!-- 가게 1개 상세보기 + menu 호출  -->
    <resultMap id="shopMap" type="shop">
        <result property="shop_id" column="shop_id" />
        <collection property="menu_list"
            column="shop_id=shop_id"
            select="selectMenuList" />
    </resultMap>

    <select id="selectMenuList" resultType="menu"> select * from menu where shop_id=#{ shop_id } </select>

    <!-- 가게 1개 상세보기  -->
    <select id="selectOne" parameterType="int" resultMap="shopMap"> select * from shop where shop_id
        = #{shop_id} </select>


    <!-- 가게 수정하기 -->
    <select id="select_modify_shop_id" parameterType="int" resultType="shop"> select * from shop
        where shop_id = #{shop_id} </select>

    <update id="update" parameterType="shop"> update shop set shop_name=#{shop_name},
        shop_content=#{shop_content}, shop_addr=#{shop_addr}, shop_call=#{shop_call},
        shop_min_price=#{shop_min_price}, shop_open_time=#{shop_open_time},
        shop_close_time=#{shop_close_time}, shop_close_day=#{shop_close_day},
        shop_area=#{shop_area}, food_category=#{food_category}, shop_status=#{shop_status},
        shop_img=#{shop_img} where shop_id = #{shop_id} </update>


    <!-- 가게 삭제하기 -->
    <delete id="delete" parameterType="int"> delete from shop where shop_id = #{shop_id} </delete>

</mapper>